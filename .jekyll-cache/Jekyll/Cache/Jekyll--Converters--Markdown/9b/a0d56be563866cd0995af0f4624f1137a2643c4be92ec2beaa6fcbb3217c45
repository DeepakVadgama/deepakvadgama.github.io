I"úÓ<p>Spring Boot is mighty powerful. It enables multitude of functionalities with minimal amount of code (thanks to annotation processing &amp; sensible defaults).</p>

<p>Listed below are a few features Iâ€™ve been using in a new project. I am creating a pre-configured scaffold code repository, will share the same soon.</p>

<ul>
  <li><a href="#general">General</a>
    <ul>
      <li><a href="#profiles">Profiles</a></li>
      <li><a href="#dependency-injection-without-annotations">Dependency injection without annotations</a></li>
      <li><a href="#hot-reload-of-code-changes">Hot reload of code changes</a></li>
    </ul>
  </li>
  <li><a href="#spring-security">Spring Security</a>
    <ul>
      <li><a href="#spring-user---roles">Spring User &amp; Roles</a></li>
      <li><a href="#password-encoding">Password encoding</a></li>
      <li><a href="#url-based-security">URL based security</a></li>
      <li><a href="#method-level-security">Method level security</a></li>
      <li><a href="#spring-expressions-based-authorization">Spring Expressions based authorization</a></li>
      <li><a href="#login--logout--cors--csrf--csp">Login, Logout, CORS, CSRF, CSP</a></li>
      <li><a href="#accessing-current-user">Accessing current user</a></li>
    </ul>
  </li>
  <li><a href="#controllers">Controllers</a>
    <ul>
      <li><a href="#input-validation">Input validation</a></li>
      <li><a href="#exception-handling">Exception handling</a></li>
      <li><a href="#entity-to-json-conversion">Entity to JSON conversion</a></li>
    </ul>
  </li>
  <li><a href="#databases---jpa---hibernate">Databases / JPA / Hibernate</a>
    <ul>
      <li><a href="#general-1">General</a></li>
      <li><a href="#flyway---database-migrations">Flyway - Database migrations</a></li>
      <li><a href="#primary-key">Primary key</a></li>
      <li><a href="#java-8-date--time-and-duration">Java 8 date, time and duration</a></li>
      <li><a href="#auditing-record-metadata">Auditing record metadata</a></li>
      <li><a href="#auditing-full-records">Auditing full records</a></li>
      <li><a href="#sql-creation">SQL creation</a></li>
    </ul>
  </li>
  <li><a href="#testing">Testing</a>
    <ul>
      <li><a href="#general-2">General</a></li>
      <li><a href="#slices">Slices</a></li>
      <li><a href="#security">Security</a></li>
      <li><a href="#jpa-testing">JPA testing</a></li>
      <li><a href="#mockmvc-and-resttemplates">MockMVC and RestTemplates</a></li>
    </ul>
  </li>
  <li><a href="#conclusion">Conclusion</a></li>
</ul>

<h2 id="general">General</h2>

<h3 id="profiles">Profiles</h3>

<p>Spring Boot allows configuration through <a href="https://docs.spring.io/spring-boot/docs/current/.../common-application-properties.html">application.properties</a>. We can have multiple profiles (application.properties), each for a distinct environment and a developer. Specific profile can chosen during application startup using <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/howto-properties-and-configuration.html#howto-set-active-spring-profiles">vm argument or system property</a> or even set it in supporting IDE like Intellij IDEA.</p>

<figure>
 <a href="https://deepakvadgama.com/images/blog/spring-boot/profiles-full.png"><img src="https://deepakvadgama.com/images/blog/spring-boot/profiles-full.png" /></a>
</figure>

<figure style="max-width: 600px; margin-left: auto; margin-right: auto">
 <a href="https://deepakvadgama.com/images/blog/spring-boot/profiles-3.png"><img src="https://deepakvadgama.com/images/blog/spring-boot/profiles-3.png" /></a>
</figure>

<h3 id="dependency-injection-without-annotations">Dependency injection without annotations</h3>

<p>Spring Boot <a href="https://spring.io/blog/2016/03/04/core-container-refinements-in-spring-framework-4-3">recommends</a> using constructors for injecting dependencies. If you have single constructor, all the dependencies are auto injected. No need to have @AutoWired or @Inject annotations. As a bonus, this also helps mocking dependencies in tests (without using Spring constructs).</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// Auto injection</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FooService</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">FooRepository</span> <span class="n">repository</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">FooService</span><span class="o">(</span><span class="nc">FooRepository</span> <span class="n">repository</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">repository</span> <span class="o">=</span> <span class="n">repository</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h3 id="hot-reload-of-code-changes">Hot reload of code changes</h3>

<p>Spring Boot has fantastic ability to auto-reload changes made to the code without restarting the server. 
If code changes are done within the method, that code snippet is auto reloaded. 
Though if there are changes to method parameters, or add/delete of methods/classes, then application needs to be restarted. Even this can be minimized by using <a href="http://docs.spring.io/spring-boot/docs/current/reference/html/howto-hotswapping.html#howto-reload-springloaded-maven">this maven plugin</a> which detects changes and restarts the application. It is faster than â€˜coldâ€™ restarts. Check out this <a href="http://docs.spring.io/spring-boot/docs/current/reference/html/howto-hotswapping.html">documentation</a> for more details.</p>

<h2 id="spring-security">Spring Security</h2>

<h3 id="spring-user--roles">Spring User &amp; Roles</h3>

<p>Spring Security requires implementing UserDetailsService, and it uses its own POJO of User (with <a href="http://docs.spring.io/spring-security/site/docs/current/apidocs/org/springframework/security/core/userdetails/User.html">limited variables</a>). 
If you require more variables you can easily extend the User class and convert instances when required by Spring Security.
 Side note: In Spring Security terminology a user-role is called Authority.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserService</span> <span class="kd">implements</span> <span class="nc">UserDetailsService</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nc">UserDetails</span> <span class="nf">loadUserByUsername</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">UsernameNotFoundException</span> <span class="o">{</span>
    
        <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">userRepository</span><span class="o">.</span><span class="na">findByUsername</span><span class="o">(</span><span class="n">username</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">user</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">UsernameNotFoundException</span><span class="o">(</span><span class="s">"Could not find user "</span> <span class="o">+</span> <span class="n">username</span><span class="o">);</span>
        <span class="o">}</span>
    
        <span class="c1">// Convert custom user to spring user</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">security</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">userdetails</span><span class="o">.</span><span class="na">User</span><span class="o">(</span>
                <span class="n">user</span><span class="o">.</span><span class="na">getUsername</span><span class="o">(),</span> <span class="n">user</span><span class="o">.</span><span class="na">getPassword</span><span class="o">(),</span> <span class="n">user</span><span class="o">.</span><span class="na">isEnabled</span><span class="o">(),</span> <span class="kc">true</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span>
                <span class="kc">true</span><span class="o">,</span> <span class="n">getAuthorities</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getRoles</span><span class="o">()));</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h3 id="password-encoding">Password encoding</h3>

<p>With Spring Security, encrypting passwords (to be persisted in DB), is as easy as writing one line of bean configuration. 
BCrypt is <a href="https://en.wikipedia.org/wiki/Bcrypt">recommended</a> option over MD5 and other hashing algorithms.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Bean</span>
<span class="kd">public</span> <span class="nc">PasswordEncoder</span> <span class="nf">encoder</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">BCryptPasswordEncoder</span><span class="o">(</span><span class="mi">11</span><span class="o">);</span>
<span class="o">}</span>
<span class="n">user</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="n">passwordEncoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="n">userDto</span><span class="o">.</span><span class="na">getPassword</span><span class="o">()));</span></code></pre></figure>

<h3 id="url-based-security">URL based security</h3>

<p>URL based security can be very easily setup with few lines of code using WebSecurity configurer. 
 This helps ensure users are authenticated and authorized to access the urls.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Configuration</span>
<span class="nd">@Order</span><span class="o">(</span><span class="nc">SecurityProperties</span><span class="o">.</span><span class="na">ACCESS_OVERRIDE_ORDER</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WebSecurityConfig</span> <span class="kd">extends</span> <span class="nc">WebSecurityConfigurerAdapter</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    
     <span class="n">http</span>
         <span class="o">.</span><span class="na">authorizeRequests</span><span class="o">()</span>
            <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/"</span><span class="o">,</span><span class="s">"/static/**"</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span>
            <span class="o">.</span><span class="na">mvcMatchers</span><span class="o">(</span><span class="s">"/admin"</span><span class="o">).</span><span class="na">access</span><span class="o">(</span><span class="s">"hasAuthority('ROLE_ADMIN')"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">mvcMatchers</span><span class="o">(</span><span class="s">"/employees"</span><span class="o">).</span><span class="na">access</span><span class="o">(</span><span class="s">"hasAuthority('ROLE_STAFF')"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">anyRequest</span><span class="o">().</span><span class="na">authenticated</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
 </code></pre></figure>

<h3 id="method-level-security">Method level security</h3>

<p>Individual methods of controllers/services can be restricted too.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Configuration</span>
<span class="nd">@EnableGlobalMethodSecurity</span><span class="o">(</span><span class="n">prePostEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WebSecurityConfig</span> <span class="kd">extends</span> <span class="nc">WebSecurityConfigurerAdapter</span> <span class="o">{</span>

<span class="o">}</span>

<span class="nd">@RestController</span> 
<span class="nd">@PreAuthorize</span><span class="o">(</span><span class="s">"hasAuthority('READ_MACHINE')"</span><span class="o">)</span>   <span class="c1">// Applies to all methods</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MachineController</span> <span class="o">{</span>
    
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/id/{machineId}"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">MachineDto</span> <span class="nf">getById</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">Long</span> <span class="n">machineId</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">machineMapper</span><span class="o">.</span><span class="na">toDto</span><span class="o">(</span><span class="n">machineService</span><span class="o">.</span><span class="na">getById</span><span class="o">(</span><span class="n">machineId</span><span class="o">));</span>
    <span class="o">}</span>
    <span class="nd">@PostMapping</span><span class="o">(</span><span class="s">"/delete/{id}"</span><span class="o">)</span>
    <span class="nd">@PreAuthorize</span><span class="o">(</span><span class="s">"hasAuthority('DELETE_MACHINE')"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">delete</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">machineService</span><span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h3 id="spring-expressions-based-authorization">Spring Expressions based authorization</h3>

<p>These restrictions need not be just based on authorities. With use of <a href="https://docs.spring.io/spring/docs/current/spring-framework.../html/expressions.html">Spring Expressions</a> 
it can trigger any service method, access parameters, access return value, access a bean etc. This can be useful for requests which depend on data, or where authorization code is dynamic and is implemented in separate service.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">IBookService</span> <span class="o">{</span>
	<span class="nd">@PreAuthorize</span> <span class="o">(</span><span class="s">"hasRole('ROLE_WRITE')"</span><span class="o">)</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">addBook</span><span class="o">(</span><span class="nc">Book</span> <span class="n">book</span><span class="o">){</span>
	    <span class="c1">//..</span>
	<span class="o">}</span>

	<span class="nd">@PostAuthorize</span> <span class="o">(</span><span class="s">"returnObject.owner == authentication.name"</span><span class="o">)</span>
	<span class="kd">public</span> <span class="nc">Book</span> <span class="nf">getBook</span><span class="o">(){</span>
	    <span class="c1">//.. </span>
	<span class="o">}</span>

	<span class="nd">@PreAuthorize</span> <span class="o">(</span><span class="s">"#book.owner == authentication.name"</span><span class="o">)</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteBook</span><span class="o">(</span><span class="nc">Book</span> <span class="n">book</span><span class="o">){</span>
	    <span class="c1">//..</span>
	<span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h3 id="login-logout-cors-csrf-csp">Login, Logout, CORS, CSRF, CSP</h3>

<p>All the security measures for web-based application are covered by default in Spring Boot. Hereâ€™s where 
Spring Boot shines with sensible defaults. I highly recommend watching <a href="https://www.infoq.com/profile/Rob-Winch">videos from Spring Security lead 
Rob Winch</a>.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Override</span>
<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>

    <span class="n">http</span>
        <span class="o">.</span><span class="na">authorizeRequests</span><span class="o">()</span>
            <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/"</span><span class="o">,</span><span class="s">"/static/**"</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span>
            <span class="o">.</span><span class="na">mvcMatchers</span><span class="o">(</span><span class="s">"/admin"</span><span class="o">).</span><span class="na">access</span><span class="o">(</span><span class="s">"hasAuthority('ROLE_ADMIN')"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">mvcMatchers</span><span class="o">(</span><span class="s">"/employees"</span><span class="o">).</span><span class="na">access</span><span class="o">(</span><span class="s">"hasAuthority('ROLE_STAFF')"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">anyRequest</span><span class="o">().</span><span class="na">authenticated</span><span class="o">()</span>
            <span class="o">.</span><span class="na">and</span><span class="o">()</span>
        <span class="o">.</span><span class="na">httpBasic</span><span class="o">()</span>
            <span class="o">.</span><span class="na">and</span><span class="o">()</span>
            <span class="o">.</span><span class="na">csrf</span><span class="o">().</span><span class="na">csrfTokenRepository</span><span class="o">(</span><span class="nc">CookieCsrfTokenRepository</span><span class="o">.</span><span class="na">withHttpOnlyFalse</span><span class="o">())</span>
            <span class="o">.</span><span class="na">and</span><span class="o">()</span>
            <span class="o">.</span><span class="na">formLogin</span><span class="o">().</span><span class="na">loginPage</span><span class="o">(</span><span class="s">"/login"</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span>
            <span class="o">.</span><span class="na">and</span><span class="o">()</span>
            <span class="o">.</span><span class="na">logout</span><span class="o">().</span><span class="na">logoutSuccessUrl</span><span class="o">(</span><span class="s">"/"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">and</span><span class="o">()</span>
        <span class="o">.</span><span class="na">headers</span><span class="o">().</span><span class="na">contentSecurityPolicy</span><span class="o">(</span><span class="s">"default-src 'self' "</span> <span class="o">+</span>
                                         <span class="s">"https://ajax.googleapis.com "</span> <span class="o">+</span>
                                         <span class="s">"https://cdnjs.cloudfare.com "</span> <span class="o">+</span>
                                         <span class="s">"style-src 'self' 'unsafe-inline' "</span><span class="o">);</span>

<span class="o">}</span>
    </code></pre></figure>

<h3 id="accessing-current-user">Accessing current user</h3>

<p>Spring can tell which user the request belongs to. This can be achieved by only using annotation 
@AuthenticationPrincipal with the method parameter (of type User). If @AuthenticationPrincipal is not very readable, then custom annotation can be created which does the same thing.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// Controller method</span>
<span class="nd">@PostMapping</span><span class="o">(</span><span class="s">"/edit/password/self"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">updatePassword</span><span class="o">(</span><span class="nd">@RequestParam</span> <span class="nc">String</span> <span class="n">updatedPassword</span><span class="o">,</span> <span class="nd">@AuthenticationPrincipal</span> <span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">userService</span><span class="o">.</span><span class="na">updatePassword</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getUsername</span><span class="o">(),</span> <span class="n">updatedPassword</span><span class="o">);</span>
<span class="o">}</span>

<span class="no">OR</span> 

<span class="c1">// Custom annotation class for AuthenticationPrincipal</span>
<span class="nd">@Target</span><span class="o">(</span><span class="nc">ElementType</span><span class="o">.</span><span class="na">PARAMETER</span><span class="o">)</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@Documented</span>
<span class="nd">@AuthenticationPrincipal</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">CurrentUser</span> <span class="o">{</span>

<span class="o">}</span>

<span class="c1">// Controller method</span>
<span class="nd">@PostMapping</span><span class="o">(</span><span class="s">"/edit/password/self"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">updatePassword</span><span class="o">(</span><span class="nd">@RequestParam</span> <span class="nc">String</span> <span class="n">updatedPassword</span><span class="o">,</span> <span class="nd">@CurrentUser</span> <span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">userService</span><span class="o">.</span><span class="na">updatePassword</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getUsername</span><span class="o">(),</span> <span class="n">updatedPassword</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>

<h2 id="controllers">Controllers</h2>

<h3 id="input-validation">Input validation</h3>

<p>Spring Boot supports <a href="http://beanvalidation.org/1.0/spec/">JSR 303</a> bean validation API. 
This is very useful in validating user inputs. 
It also supports additional hibernate validators, for values to be validated from database (eg: unique email)</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Person</span> <span class="o">{</span>
    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">max</span><span class="o">=</span><span class="mi">30</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Min</span><span class="o">(</span><span class="mi">18</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Integer</span> <span class="n">age</span><span class="o">;</span>
    
    <span class="nd">@NotEmpty</span> 
    <span class="nd">@Column</span><span class="o">(</span><span class="n">unique</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@PostMapping</span><span class="o">(</span><span class="s">"/add"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">add</span><span class="o">(</span><span class="nd">@Valid</span> <span class="nc">Person</span> <span class="n">person</span><span class="o">,</span> <span class="nc">BindingResult</span> <span class="n">bindingResult</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">bindingResult</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
        <span class="c1">// handle errors</span>
        <span class="k">return</span> <span class="s">"error"</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="s">"success"</span><span class="o">;</span>
<span class="o">}</span></code></pre></figure>

<h3 id="exception-handling">Exception handling</h3>

<p>When exceptions are not handled in Controllers, they are returned to the caller as exception stack traces. 
Spring Boot supports Global exception handling, where-in we can choose the message and http status to return, 
based on type of exceptions.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@RestControllerAdvice</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GlobalExceptionHandler</span> <span class="o">{</span>
    
    <span class="nd">@ResponseStatus</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">BAD_REQUEST</span><span class="o">)</span>
    <span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="nc">BadInputException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">badRequest</span><span class="o">(</span><span class="nc">BadInputException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="nd">@ResponseStatus</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">INTERNAL_SERVER_ERROR</span><span class="o">)</span>
    <span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="nc">Exception</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">badRequest</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h3 id="entity-to-json-conversion">Entity to JSON conversion</h3>

<p>Spring Boot uses Jackson to convert entity/domain objects into JSON for consumption by clients (UI).
There are multiple ways to achieve this:</p>

<ul>
  <li>Let Spring convert whole class instance (along with its nested hierarchy) into JSON</li>
  <li>Use <a href="http://docs.spring.io/spring-data/rest/docs/current/reference/html/#projections-excerpts.projections.hidden-data">annotation @JsonIgnore</a> to hide some fields from conversion. Eg: for password field, which should not be sent to UI</li>
  <li>Use <a href="https://spring.io/blog/2014/12/02/latest-jackson-integration-improvements-in-spring">JSON views</a>, to contextually convert entities based on requests</li>
  <li>Use <a href="https://en.wikipedia.org/wiki/Data_transfer_object">separate DTO classes</a>, and write mappers to convert entity to DTO and vice-versa. DTO pattern is <a href="https://martinfowler.com/bliki/LocalDTO.html">controversial</a>, but the overhead of mappers can be reduced by <a href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/beans/BeanUtils.html">BeanUtils.copyProperties()</a></li>
</ul>

<h2 id="databases--jpa--hibernate">Databases / JPA / Hibernate</h2>

<h3 id="general-1">General</h3>

<p>Spring Boot (and Spring Data JPA) allows for lot of basic functionalities with minimal code:</p>

<ul>
  <li>@Column and @Table annotation for entity is optional, naming strategies have <a href="https://docs.jboss.org/hibernate/orm/5.1/userguide/html_single/chapters/domain/naming.html">sensible defaults</a>.</li>
  <li>Lazy fetching of nested object <a href="https://dzone.com/articles/jpa-lazy-loading">hierarchy</a></li>
  <li>Field validations as mentioned above</li>
  <li><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/howto-database-initialization.html">DDL validation</a> during startup</li>
  <li>Transactions with annotations <a href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#transactions">@transactional and @transactional(readonly = true)</a></li>
  <li>JPA Repositories for <a href="https://docs.spring.io/spring-data/data-commons/docs/1.6.1.RELEASE/reference/html/repositories.html">CRUD and Paging/Sorting</a></li>
  <li>Optimistic locking with <a href="http://www.byteslounge.com/tutorials/jpa-entity-versioning-version-and-optimistic-locking">single field/annotation of @version</a></li>
</ul>

<h3 id="flyway---database-migrations">Flyway - Database migrations</h3>

<p>We have ample resources for deployments and rollback of the code, but very limited tools for doing the same
for database changes done during the release. <a href="https://flywaydb.org/">Flyway</a> is an excellent tool which does just that.
Spring Boot integrates nicely with Flyway.</p>

<p>Check out <a href="https://flywaydb.org/getstarted/how">this page</a> for how flyway works. It is quite useful and effective
for DB upgrades and rollbacks.</p>

<p>Check out <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/howto-database-initialization.html">this sample repository</a></p>

<figure style="max-width: 300px">
  <a href="https://deepakvadgama.com/images/blog/spring-boot/flyway.png"><img src="https://deepakvadgama.com/images/blog/spring-boot/flyway.png" /></a>
 </figure>

<h3 id="primary-key">Primary key</h3>

<p>Primary key for records can be generated using one of these types (IDENTITY, SEQUENCE, TABLE).
 Each has pros and cons. For most use cases AUTO will do Check out <a href="http://www.thoughts-on-java.org/jpa-generate-primary-keys/">more details here</a> and <a href="https://en.wikibooks.org/wiki/Java_Persistence/Identity_and_Sequencing#Identity">here</a>
The default value for @GeneratedValue is AUTO.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java">    <span class="nd">@Entity</span>
    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    
        <span class="nd">@Id</span>
        <span class="nd">@GeneratedValue</span>
        <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span></code></pre></figure>

<h3 id="java-8-date-time-and-duration">Java 8 date, time and duration</h3>

<p>Earlier Joda Date (&amp; Java 8 date) had to be converted to java.sql.Date to persist into DB. 
This manual conversion can be avoided by adding only a converter in configuration. 
Now all entities can use Java 8â€™s Date, Time and Duration classes and the values are stored and retrieved
correctly from database.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@EntityScan</span><span class="o">(</span><span class="n">basePackageClasses</span> <span class="o">=</span> <span class="o">{</span><span class="nc">MyApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">Jsr310JpaConverters</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
<span class="nd">@SpringBootApplication</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyApplication</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">MachineMaintenanceApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h3 id="auditing-record-metadata">Auditing record metadata</h3>

<p>Auditing the metadata of creates &amp; updates is supported out of the box.</p>

<ul>
  <li>Using @CreatedDate and @ModifiedDate annotations on entity fields is enough for those columns to be 
 populated each time a record is created or updated.</li>
  <li>Using @CreatedBy and @ModifiedBy annotations allow to insert user who created/updated the record. For this, 
Spring needs to know who is the auditor. This auditor can be configured with few lines of code.</li>
  <li>The modified-date and modified-by fields only store data related to latest update.</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Entity</span>
<span class="nd">@EntityListeners</span><span class="o">(</span><span class="nc">AuditingEntityListener</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Person</span> <span class="o">{</span>
    
    <span class="nd">@Column</span><span class="o">(</span><span class="n">columnDefinition</span> <span class="o">=</span> <span class="s">"DATETIME"</span><span class="o">,</span> <span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">updatable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="nd">@CreatedDate</span>
    <span class="kd">protected</span> <span class="nc">LocalDateTime</span> <span class="n">createdDate</span><span class="o">;</span>
    
    <span class="nd">@Column</span><span class="o">(</span><span class="n">columnDefinition</span> <span class="o">=</span> <span class="s">"DATETIME"</span><span class="o">)</span>
    <span class="nd">@LastModifiedDate</span>
    <span class="kd">protected</span> <span class="nc">LocalDateTime</span> <span class="n">modifiedDate</span><span class="o">;</span>
    
    <span class="nd">@CreatedBy</span>
    <span class="kd">protected</span> <span class="nc">String</span> <span class="n">createdBy</span><span class="o">;</span>
    
    <span class="nd">@LastModifiedBy</span>
    <span class="kd">protected</span> <span class="nc">String</span> <span class="n">modifiedBy</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// Auditor Config</span>
<span class="nd">@Configuration</span>
<span class="nd">@EnableJpaAuditing</span><span class="o">(</span><span class="n">auditorAwareRef</span> <span class="o">=</span> <span class="s">"auditorProvider"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PersistenceConfig</span> <span class="o">{</span>

    <span class="nd">@Bean</span>
    <span class="nc">AuditorAware</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">auditorProvider</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">AuditorAwareImpl</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="c1">// This class is used for Spring JPA entities to get &amp; populate createdBy and modifiedBy username strings</span>
    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">AuditorAwareImpl</span> <span class="kd">implements</span> <span class="nc">AuditorAware</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getCurrentAuditor</span><span class="o">()</span> <span class="o">{</span>
            <span class="nc">Authentication</span> <span class="n">authentication</span> <span class="o">=</span> <span class="nc">SecurityContextHolder</span><span class="o">.</span><span class="na">getContext</span><span class="o">().</span><span class="na">getAuthentication</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">authentication</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="o">!</span><span class="n">authentication</span><span class="o">.</span><span class="na">isAuthenticated</span><span class="o">())</span> <span class="o">{</span>
                <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="o">((</span><span class="nc">User</span><span class="o">)</span> <span class="n">authentication</span><span class="o">.</span><span class="na">getPrincipal</span><span class="o">()).</span><span class="na">getUsername</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h3 id="auditing-full-records">Auditing full records</h3>

<p><a href="hibernate.org/orm/envers/">Hibernate envers</a> allows to audit entire row of the database each time it is updated. It can be easily used in Spring Boot by using a lightweight wrapper project called <a href="https://github.com/spring-projects/spring-data-envers">Spring-data-envers</a>. The auditing comes extremely handy. The database can be just 
queried for changes instead of digging through the logs (or using log parsers). The audited records can also be accessed programmatically by extending RevisionRepository.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Entity</span>
<span class="nd">@Audited</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Person</span> <span class="o">{</span>
    <span class="c1">//...fields...    </span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">PersonRepository</span> <span class="kd">extends</span> <span class="nc">RevisionRepository</span><span class="o">&lt;</span><span class="nc">Machine</span><span class="o">,</span> <span class="nc">Long</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;,</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">Machine</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="c1">//..extra methods.. </span>
<span class="o">}</span>

<span class="nd">@Configuration</span>
<span class="nd">@EnableJpaRepositories</span><span class="o">(</span><span class="n">repositoryFactoryBeanClass</span> <span class="o">=</span> <span class="nc">EnversRevisionRepositoryFactoryBean</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PersistenceConfig</span> <span class="o">{</span>
  <span class="c1">//.... </span>
<span class="o">}</span></code></pre></figure>

<h3 id="sql-creation">SQL creation</h3>

<p>Hibernate can <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/howto-database-initialization.html">create the missing tables on application startup</a> (based on the entity classes in the application). If <a href="https://flywaydb.org/">Flyway DB</a> is being used, we need to have create/update queries (DDL) in flyway SQL scripts. These queries need not be written manually. They can be generated by Hibernate on application startup. Once configured, all the DDL queries (along with constraints, indexes and joins) are dumped into the specific file from which we can copy-paste to Flyway SQL scripts file.</p>

<figure class="highlight"><pre><code class="language-properties" data-lang="properties"><span class="py">spring.jpa.properties.javax.persistence.schema-generation.create-source</span><span class="p">=</span><span class="s">metadata</span>
<span class="py">spring.jpa.properties.javax.persistence.schema-generation.scripts.action</span><span class="p">=</span><span class="s">create</span>
<span class="py">spring.jpa.properties.javax.persistence.schema-generation.scripts.create-target</span><span class="p">=</span><span class="s">create.sql</span></code></pre></figure>

<figure style="max-width: 600px">
 <a href="https://deepakvadgama.com/images/blog/spring-boot/create-sql.png"><img src="https://deepakvadgama.com/images/blog/spring-boot/create-sql.png" /></a>
</figure>

<h2 id="testing">Testing</h2>

<h3 id="general-2">General</h3>

<ul>
  <li>@ActiveProfile: Chooses the profile to be used (for all tests in that class)</li>
  <li>@DirtiesContext: Resets context after every test</li>
  <li>@TestPropertySource: Adds extra test properties configuration</li>
  <li>@ComponentScan: Scan only specific package classes to speeden up the process</li>
</ul>

<h3 id="slices">Slices</h3>

<p>Spring Boot allows to test each individual layer (DAO, Controller etc) separately. 
 Each layer has corresponding annotations (@WebMvcTest, @DataJpaTest) to be used. 
 This helps in fast execution of tests, (initialization of layers unrelated to the tests
 are be avoided), also making code more succinct. Check <a href="https://www.google.co.in/search?client=safari&amp;rls=en&amp;q=spring+boot+1.4+testing&amp;ie=UTF-8&amp;oe=UTF-8&amp;gfe_rd=cr&amp;ei=5z2KWPvrJtP08wft55qABA">this article</a> for more details.</p>

<h3 id="security">Security</h3>

<p>If application is configured to use authentication and authorization, users (for the requests) can be configured per test-class or per test-method. Also, user can be set with specific authorities, or an existing DB user can be used.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Sql</span><span class="o">(</span><span class="s">"classpath:mock-user.sql"</span><span class="o">)</span>   <span class="c1">// Insert test data</span>
<span class="nd">@WithUserDetails</span><span class="o">(</span><span class="s">"user1"</span><span class="o">)</span>     <span class="c1">// Run all methods of class with user1</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AuditingTests</span> <span class="o">{</span>
    
    <span class="nd">@Test</span>
    <span class="nd">@WithAnonymousUser</span>   <span class="c1">// Run with anonymous user</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testUnAuthenticated</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="n">mvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/test/freeaccess"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">())</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">content</span><span class="o">().</span><span class="na">string</span><span class="o">(</span><span class="s">"Working"</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@WithMockUser</span><span class="o">(</span><span class="n">username</span> <span class="o">=</span> <span class="s">"testUser"</span><span class="o">,</span> <span class="n">authorities</span> <span class="o">=</span> <span class="o">{</span><span class="s">"ANY_PERMISSION"</span><span class="o">})</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testAuthenticatedSuccess</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="n">mvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/test/authenticated"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">())</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">content</span><span class="o">().</span><span class="na">string</span><span class="o">(</span><span class="s">"Authenticated"</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h3 id="jpa-testing">JPA testing</h3>

<p>During JPA testing,</p>

<ul>
  <li>@DataJpaTest can be used for testing just JPA layer</li>
  <li>@AutoConfigureTestDatabase can be used to auto-configure test database (requires H2 or similar DB in classpath)</li>
  <li>@Sql can be used to insert mock data before tests run</li>
  <li>@EnableJpaAuditing can be used to well, enable auditing</li>
  <li>@AutoConfigureTestEntityManager can be used to auto-configure entity manager for persisting entities</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@RunWith</span><span class="o">(</span><span class="nc">SpringRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@SpringBootTest</span><span class="o">(</span><span class="n">webEnvironment</span> <span class="o">=</span> <span class="nc">WebEnvironment</span><span class="o">.</span><span class="na">RANDOM_PORT</span><span class="o">)</span>
<span class="nd">@AutoConfigureTestEntityManager</span>
<span class="nd">@AutoConfigureTestDatabase</span>
<span class="nd">@EnableJpaAuditing</span>
<span class="nd">@Sql</span><span class="o">(</span><span class="s">"classpath:mock-user.sql"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AuditingTests</span> <span class="o">{</span>

<span class="o">}</span></code></pre></figure>

<h3 id="mockmvc-and-resttemplates">MockMVC and RestTemplates</h3>

<p>The controllers can be tested using either mock-mvc or with rest templates. MockMVC as name suggests only mocks the network calls. With rest-templates, server needs to be started and <a href="http://stackoverflow.com/a/25902063/3494368">network calls are made</a> for testing.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"> <span class="nd">@RunWith</span><span class="o">(</span><span class="nc">SpringRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
 <span class="nd">@SpringBootTest</span><span class="o">(</span><span class="n">webEnvironment</span><span class="o">=</span><span class="nc">WebEnvironment</span><span class="o">.</span><span class="na">RANDOM_PORT</span><span class="o">)</span>
 <span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyTest</span> <span class="o">{</span>
    
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">TestRestTemplate</span> <span class="n">restTemplate</span><span class="o">;</span>
    
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">restTemplate</span><span class="o">.</span><span class="na">getForEntity</span><span class="o">(</span>
            <span class="s">"/{username}/vehicle"</span><span class="o">,</span> <span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"Phil"</span><span class="o">);</span>
    <span class="o">}</span>
 <span class="o">}</span>
 
 <span class="no">OR</span>
 
 <span class="nd">@RunWith</span><span class="o">(</span><span class="nc">SpringRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
 <span class="nd">@SpringBootTest</span><span class="o">(</span><span class="n">webEnvironment</span> <span class="o">=</span> <span class="nc">WebEnvironment</span><span class="o">.</span><span class="na">RANDOM_PORT</span><span class="o">)</span>
 <span class="nd">@TestPropertySource</span><span class="o">(</span><span class="n">locations</span> <span class="o">=</span> <span class="s">"classpath:test.properties"</span><span class="o">)</span>
 <span class="nd">@AutoConfigureTestDatabase</span>
 <span class="kd">public</span> <span class="kd">class</span> <span class="nc">MachineIntegrationTests</span> <span class="o">{</span>
 
     <span class="nd">@Autowired</span>
     <span class="kd">private</span> <span class="nc">WebApplicationContext</span> <span class="n">context</span><span class="o">;</span>
 
     <span class="kd">private</span> <span class="nc">MockMvc</span> <span class="n">mvc</span><span class="o">;</span>
 
     <span class="nd">@Before</span>
     <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setup</span><span class="o">()</span> <span class="o">{</span>
         <span class="n">mvc</span> <span class="o">=</span> <span class="nc">MockMvcBuilders</span>
                 <span class="o">.</span><span class="na">webAppContextSetup</span><span class="o">(</span><span class="n">context</span><span class="o">)</span>
                 <span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">springSecurity</span><span class="o">())</span>
                 <span class="o">.</span><span class="na">build</span><span class="o">();</span>
     <span class="o">}</span>
    
     <span class="nd">@Test</span>
     <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testUnAuthenticated</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
         <span class="n">mvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/test/freeaccess"</span><span class="o">))</span>
                 <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">())</span>
                 <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">content</span><span class="o">().</span><span class="na">string</span><span class="o">(</span><span class="s">"Working"</span><span class="o">));</span>
     <span class="o">}</span>
 <span class="o">}</span>
 </code></pre></figure>

<h2 id="conclusion">Conclusion</h2>

<p>Phew! Thatâ€™s a long list, and yet it does not cover all the features Spring Boot has to offer (eg: <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-metrics.html">Actuators and metrics</a>). It amazes me that Java development has come this far. I still remember reinventing the wheel (&amp; writing too much code for it) for every project, not to mention the testing required. This is even more amazing considering Spring Boot (&amp; family) is completely free and open-source. Good times!</p>

<p>Hit me up in the comments if I missed anything or if you have any queries.</p>
:ET